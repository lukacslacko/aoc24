data =: (#~0<#@>) <;._1 LF,CR-.~1!:1 < 'day6.txt'
N=:#data
i=:,>data
d=.-.&'X.#'
s=:<(d i);(i.d)i
t=:{{
'd p'=:;{:y
x{{
np=.p+(_1,1,(-N),N){~'<>^v'i.d
y,('#'=np{x){(<d;np),<('^v><'{~'<>^v'i.d);p
}}^:(((<.p%N){{-.+./((d='<')*.y=0),((d='>')*.y=N-1),((d='^')*.x=0),((d='v')*.x=N-1)}}0(+m.N)p)*.-.({:e.}:)y)y
}} 
vp=:,~.>{:"1>i t^:_ s
result_1 =: #vp
result_2 =: +/{{({:e.}:)('#'y}i)t^:_ s}}"0 vp([#~'.'=[{])i
